
# 图块编程

图块编程是一种抽象编程, 是计算机语言的一种表现形式. 未来计算机抽象语言也必然会和汉语, 英语一样成为人人必会的常识技能. 然而语言最长见的便是句子, 对应的便是图块编程里的一个图块.

句子常为服务于人类生活而生, 虽无穷尽, 但实际使用还是比较常见的一些可枚举的. 因此我们也只需提供为产品服务的一些常用的功能模块即可为产品带来丰富多样性和灵活性.

## 特性

- 扩展性, 方便衍生新的图块
- 易用性, 使用简单

## 功能点

- 图块搜索
- 文件浏览器

## 用法

- 在世界目录新建一个自动加载目录, 类似window程序自启动, 将xml文件存于其中, 世界加载后自动加载运行xml文件

## 编程

编程主要是智能编程或图块编程, 编程可以让世界更加真实有趣. 也是学习编程的基础功能, 此功能要做的比较可用需依赖一下功能:

[x--] 基本UI框架 mcml2 已有, 但性能和可扩展性不好. 很多css属性控制的东西全用html属性去控制, 页面布局写的比较难理解而且支持的布局方式很弱, 最致命就任何数据更新基本都需要刷新整个页面
[x--] 基于 mcml2 可用性, 需要构建一套比较优基础UI框架, 目前已重构部分, 不依赖mcml2已实现窗口基本功能, 还需实现Scroll, Input, ClassStyle, 新框架不会refesh和重新加载元素, 根据样式变化更新部分元素布局甚至不更新布局(只有影响布局的样式改更才布局)
[x--] 基于基础UI框架构建一套高级通用的UI组件库和框, 目前基于Vue和ElementUI思路实现. 基于旧的mcml2已实现基本可用的vue框架, 可较短时间切换新的基础UI框架, 高级UI组件库暂无
[x] 拖拽元素构建UI, 提高开发效果, 可选
[x--] 图块编程工具, 目前基于 scratch 定制差, 需要启动内置浏览器, 体验性差.  
[x--] 基于图块编程或拖拽编程实现智能化编程, 有效快速完成自定义UI显示以及世界里相关可以代码的控制的方块与人物

## TODO

[x] 图块外框
[x] 代码生成
[x] 不在视图内 不渲染 不然性能比较差
[x] 撤销与恢复
[ ] 兼容blockly 难度系数大(实现不同导致序列化存贮的数据不同, 格式也不同) 浏览器版本是否可以重写blockly,  毕竟blockly不开源使用难度大
[ ] 对象编辑
[x] 代码块
[ ] 自启动
[x] 字段验证器
[x] 可变输入
[x] 自动转换旧块的定义
[x] 白边
[x] 手机按键
[x] 手机版工具栏滚动
[x] 输入需要支持光标移走即保存
[x] 要生成图块对应的代码供用户查看
[x] 部分图块的形状需要与之前的保持一致，便于用户理解（如，控制-循环）
[x] 取消NPL图块勾选后，来回切换图块还显示不对的问题  未知问题
[x-] 需要支持右键菜单操作
[x] 需要支持ctrl+y/ctrl+z的快捷键操作
[x] 需要支持图块放大/缩小及回收站功能
[x-] UI界面还需要美化
[x] Cad 孙子兵法图块支持
[x] blockly 内部更新事件回调
[x] 录制与播放不同分辨率位置错乱, 分辨率各种回调处理顺序不一致造成, 需要控制处理需顺序, window 先处理, trigger后处理.
[x] 渲染性能优化
[x] 宏示教优化, 增加语音字幕讲解, 增加宏增删改合并等操作, 文字输入等待卡顿优化
[x] 图块代码转化兼容存在问题
[x-] 自定义工具栏图块和工作区图块 (工具栏尽量只提供完成指定功能所需的图块, 避免全部显示, 全部图块变化大, 示教兼容难以保存, 只提供所需图块可以避免相关问题和降低使用难度)
[x-] 提供使用图块编辑去自定义用户图块 (将世界中代码方块函数转换成图块, 供世界使用者使用)
[ ] blockly 导出导入
[ ] 文本代码图块互转
[x] 缺少并行图块, 定制世界图块保存报错
[x-] 图块自动生成宏示教
[x-] 启动块
[x] 对象 列表操作图块
[x] 动态字段图块
[ ] https://note.youdao.com/ynoteshare1/index.html?id=8e1d03931b89c03ebff09565a99ebc06&type=note

## 图片

## 定制图块

为简化使用和学习难度, 应尽量针对问题定制所需要图块, 通过简单拖拽拼接等简易操作完成相关代码实现解决相应.

为了更好的定制图块, 提供了通过图块编辑器去编辑自定义图块功能, 此外该功能会提供一定量基础通用图块供用户参考学习以及使用,

系统默认会提供 Lua 基本语法, 代码方块 API 等基础常用定制图块, 用户可基于此再次定义来简化最终的使用.

### 图块命名规则

系统图块命名规则: System_类别_功能
世界通用图块命令规则: World_类别_功能
用户自定义图块命令规则: User_类别_功能

### 图块基本组成

图块由属性, 字段, 输入三个部分, 属性定义图块的外观及功能等, 字段提供数据输入, 输入提供图块输入. 下面简单介绍其常用功能:

- 图块类型: 图块标识符, 用于区分不同图块. 也是图块名称, 设置其值时可参考图块命名规则
- 图块类别: 图块所属分类, 用于方便管理和图在编辑器中快速定位
- 图块颜色: 定义图块的外观颜色, 当所属分类存在颜色时, 会被分类颜色取代.
- 图块连接: 定义图块拼接方式, 目前存值连接(代表一个数据值)语句连接(代表一条语句).  后续可能补加启动连接(用于指定程序启动代码), 连接后续也会支持类型匹配以便更加智能准确完成相关需求
- 字段文本: 用于图块显示的文本, 不可编辑修改
- 字段输入: 用于数字与文本的输入
- 字段列表: 提供一种下拉列表选择方式输入文本, 需匹配列表项图块一起使用
- 输入值:   提供值图块的输入
- 输入语句: 提供语句块的输入
- 连接类型: 设置图块匹配规则
- 代码格式: 指定图块定义的代码模板, 使用 ${FIELD_INPUT_NAME} 来获取字段和输入的内容, FIELD_INPUT_NAME 字段或输入的名称 如字符串 `"${STRING_FIELD_NAME}"` 其中 ${STRING_FIELD_NAME} 会被文本字段输入的内容, STRING_FIELD_NAME 为文本字段图块设置名称值

### 定制图块的使用

定制图块输入高级功能, 需要一定图块基础才能灵活使用. 在图块定制界面也包含定制图块编辑器, 在里面可以自由使用定制图块并实时显示生成的目标代码, 用以验证自定图块是否正确. 若想在代码图块中使用定制图块, 

可在代码图块编辑器的设置中启用NPL 图块编辑器和启动自定义图块两个选项即可.

### 如何正确使用图块编程

图块编程不是代替代码编程, 图块编程偏向通过编程思维去定义程序功能从而智能化完成相关任务. 未来人人具备编程思维, 但仍只有极少人从事编程工作, 图块编程是展现编程思维的一种方式但并不唯一, 因此图块编程主用于编程思维的学习与应用.

图块编程是定义功能, 代码编程是实现功能, 这两者主要不同点.

没有代码编程和图块编程能力的人会图块编程很简单很好用
没有代码编程和有图块编程能力的人会图块编程还行, 可以解决相关问题
有代码编程和有图块编程能力的人会时常觉得图块编程不够方便, 此时不要希望图块编程解决你的不方便, 你应该通过自定义图块解决. 编写相关代码映射成自定义图块.

无编程思维 => 有编程思维: 搭建编程思维学习场景, 通过简单拖拽拼接图块完成相关任务, 从而认识感知编程.
有编程思维 => 代码编程: 通过图块编程练习编程能力
代码编程 => 自定义图块编程: 将代码定义图块

### 方向

- 猿编程 App 基于图块编程的APP应用.
- Paracraft 社区
- 自定义APP
